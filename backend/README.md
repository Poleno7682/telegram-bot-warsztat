# Telegram Bot - Auto Service Booking System

Backend ะดะปั ัะธััะตะผั ะทะฐะฟะธัะธ ะบะปะธะตะฝัะพะฒ ะฝะฐ ะฐะฒัะพัะตัะฒะธั ัะตัะตะท Telegram Bot.

## ะัะพะฑะตะฝะฝะพััะธ

- โ ะัะธะฝััะพะฝะฝะฐั ะฐััะธัะตะบัััะฐ (aiogram 3.x + SQLAlchemy async)
- โ ะะฝะพะณะพัะทััะฝะพััั (ะฟะพะปััะบะธะน/ััััะบะธะน) ั ะปะตะณะบะธะผ ะดะพะฑะฐะฒะปะตะฝะธะตะผ ะฝะพะฒัั ัะทัะบะพะฒ
- โ SOLID ะฟัะธะฝัะธะฟั
- โ ะกะธััะตะผะฐ ัะพะปะตะน (ะะดะผะธะฝะธัััะฐัะพั, ะะตัะฐะฝะธะบ, ะะพะปัะทะพะฒะฐัะตะปั)
- โ Workflow ัะพะณะปะฐัะพะฒะฐะฝะธั ะทะฐะฟะธัะตะน
- โ ะะฒัะพะผะฐัะธัะตัะบะธะน ัะฐััะตั ัะฒะพะฑะพะดะฝะพะณะพ ะฒัะตะผะตะฝะธ
- โ ะะฒัะพะผะฐัะธัะตัะบะธะน ะฟะตัะตะฒะพะด ัะตะบััะฐ (googletrans)

## ะกัััะบัััะฐ ะฟัะพะตะบัะฐ

```
backend/
โโโ app/
โ   โโโ __init__.py
โ   โโโ main.py                    # Entry point
โ   โโโ config/
โ   โ   โโโ __init__.py
โ   โ   โโโ settings.py            # ะะฐัััะพะนะบะธ ะฟัะธะปะพะถะตะฝะธั
โ   โ   โโโ database.py            # Database configuration
โ   โโโ core/
โ   โ   โโโ __init__.py
โ   โ   โโโ i18n/                  # ะกะธััะตะผะฐ ะผะฝะพะณะพัะทััะฝะพััะธ
โ   โ   โ   โโโ __init__.py
โ   โ   โ   โโโ loader.py          # ะะฐะณััะทัะธะบ ะฟะตัะตะฒะพะดะพะฒ
โ   โ   โ   โโโ locales/           # JSON ัะฐะนะปั ะฟะตัะตะฒะพะดะพะฒ
โ   โ   โ       โโโ pl.json
โ   โ   โ       โโโ ru.json
โ   โ   โโโ dependencies/          # DI ะบะพะฝัะตะนะฝะตั
โ   โโโ models/
โ   โ   โโโ __init__.py
โ   โ   โโโ base.py
โ   โ   โโโ user.py
โ   โ   โโโ service.py
โ   โ   โโโ booking.py
โ   โ   โโโ settings.py
โ   โโโ repositories/              # Repository pattern (SOLID)
โ   โ   โโโ __init__.py
โ   โ   โโโ base.py
โ   โ   โโโ user.py
โ   โ   โโโ service.py
โ   โ   โโโ booking.py
โ   โโโ services/                  # Business logic
โ   โ   โโโ __init__.py
โ   โ   โโโ auth_service.py
โ   โ   โโโ booking_service.py
โ   โ   โโโ time_service.py
โ   โ   โโโ translation_service.py
โ   โโโ bot/
โ   โ   โโโ __init__.py
โ   โ   โโโ handlers/              # Bot handlers
โ   โ   โ   โโโ __init__.py
โ   โ   โ   โโโ start.py
โ   โ   โ   โโโ admin.py
โ   โ   โ   โโโ mechanic.py
โ   โ   โ   โโโ user.py
โ   โ   โโโ middlewares/
โ   โ   โ   โโโ __init__.py
โ   โ   โ   โโโ auth.py
โ   โ   โ   โโโ i18n.py
โ   โ   โโโ keyboards/
โ   โ   โ   โโโ __init__.py
โ   โ   โ   โโโ inline.py
โ   โ   โโโ states/
โ   โ   โ   โโโ __init__.py
โ   โ   โ   โโโ booking.py
โ   โ   โโโ utils/
โ   โ       โโโ __init__.py
โ   โ       โโโ helpers.py
โ   โโโ utils/
โ       โโโ __init__.py
โ       โโโ logger.py
โโโ alembic/                       # Database migrations
โ   โโโ versions/
โ   โโโ env.py
โโโ systemd/
โ   โโโ telegram-bot.service       # Systemd service file
โโโ .env.example
โโโ .gitignore
โโโ requirements.txt
โโโ alembic.ini
โโโ README.md
```

## ะฃััะฐะฝะพะฒะบะฐ

### 1. ะะปะพะฝะธัะพะฒะฐะฝะธะต ัะตะฟะพะทะธัะพัะธั

```bash
git clone <repository-url>
cd backend
```

### 2. ะฃััะฐะฝะพะฒะบะฐ ะทะฐะฒะธัะธะผะพััะตะน

```bash
# Linux/Mac (ะฑะตะท venv)
python3 -m pip install --upgrade pip --user
python3 -m pip install -r requirements.txt --user
```

### 4. ะะฐัััะพะนะบะฐ ะพะบััะถะตะฝะธั

```bash
cp .env.example .env
# ะััะตะดะฐะบัะธััะนัะต .env ัะฐะนะป, ัะบะฐะทะฐะฒ BOT_TOKEN ะธ ADMIN_IDS
```

### 5. ะะฝะธัะธะฐะปะธะทะฐัะธั ะฑะฐะทั ะดะฐะฝะฝัั

```bash
alembic upgrade head
```

### 6. ะะฐะฟััะบ ะฑะพัะฐ

```bash
python -m app.main
```

## ะะตะฟะปะพะน ะฝะฐ VPS (Linux)

### 1. ะะพะดะณะพัะพะฒะบะฐ ัะตัะฒะตัะฐ

```bash
# ะะฑะฝะพะฒะปะตะฝะธะต ัะธััะตะผั
sudo apt update && sudo apt upgrade -y

# ะฃััะฐะฝะพะฒะบะฐ Python 3.11+
sudo apt install python3 python3-pip -y

# ะฃััะฐะฝะพะฒะบะฐ PostgreSQL (ะพะฟัะธะพะฝะฐะปัะฝะพ)
sudo apt install postgresql postgresql-contrib -y
```

### 2. ะะพะฟะธัะพะฒะฐะฝะธะต ะฟัะพะตะบัะฐ

```bash
# ะะฐะณััะทะบะฐ ะฟัะพะตะบัะฐ ะฝะฐ ัะตัะฒะตั
cd /opt
sudo git clone <repository-url> telegram-bot
cd telegram-bot/backend
```

### 3. ะฃััะฐะฝะพะฒะบะฐ Python ะทะฐะฒะธัะธะผะพััะตะน

```bash
python3 -m pip install --upgrade pip --user
python3 -m pip install -r requirements.txt --user
```

### 4. ะะฐัััะพะนะบะฐ .env

```bash
sudo cp .env.example .env
sudo nano .env  # ะะตะดะฐะบัะธัะพะฒะฐะฝะธะต ะบะพะฝัะธะณััะฐัะธะธ
```

### 5. ะะฐัััะพะนะบะฐ Systemd Service

```bash
sudo cp systemd/telegram-bot.service /etc/systemd/system/
sudo systemctl daemon-reload
sudo systemctl enable telegram-bot
sudo systemctl start telegram-bot
```

### 6. ะัะพะฒะตัะบะฐ ััะฐัััะฐ

```bash
sudo systemctl status telegram-bot
```

### 7. ะัะพัะผะพัั ะปะพะณะพะฒ

```bash
journalctl -u telegram-bot -f
```

## ะะพะปะธ ะฟะพะปัะทะพะฒะฐัะตะปะตะน

### ะะดะผะธะฝะธัััะฐัะพั
- ะะฐะทะฝะฐัะฐะตััั ัะตัะตะท ADMIN_IDS ะฒ .env
- ะะพะถะตั ะฝะฐะทะฝะฐัะฐัั ะผะตัะฐะฝะธะบะพะฒ ะธ ะฟะพะปัะทะพะฒะฐัะตะปะตะน
- ะะพะถะตั ัะฟัะฐะฒะปััั ััะปัะณะฐะผะธ ะธ ะฝะฐัััะพะนะบะฐะผะธ
- ะะพะถะตั ัะพะทะดะฐะฒะฐัั ะทะฐะฟะธัะธ (ะฝะพ ะฝะต ะฟัะธะฝะธะผะฐะตั ะธั ะบะฐะบ ะผะตัะฐะฝะธะบ)

### ะะตัะฐะฝะธะบ
- ะะฐะทะฝะฐัะฐะตััั ัะตัะตะท MECHANIC_IDS ะฒ .env ะธะปะธ ัะตัะตะท ะฑะพัะฐ
- ะะพะถะตั ัะพะทะดะฐะฒะฐัั ะทะฐะฟะธัะธ
- ะัะธะฝะธะผะฐะตั/ะพัะบะปะพะฝัะตั/ะธะทะผะตะฝัะตั ะฒัะตะผั ะทะฐะฟะธัะตะน
- ะะพะถะตั ัะฟัะฐะฒะปััั ััะปัะณะฐะผะธ ะธ ะฝะฐัััะพะนะบะฐะผะธ

### ะะพะปัะทะพะฒะฐัะตะปั
- ะะฐะทะฝะฐัะฐะตััั ัะตัะตะท USER_IDS ะฒ .env ะธะปะธ ัะตัะตะท ะฑะพัะฐ
- ะะพะถะตั ัะพะปัะบะพ ัะพะทะดะฐะฒะฐัั ะฝะพะฒัะต ะทะฐะฟะธัะธ
- ะฃัะฐััะฒัะตั ะฒ ัะพะณะปะฐัะพะฒะฐะฝะธะธ ะฒัะตะผะตะฝะธ ั ะผะตัะฐะฝะธะบะฐะผะธ

## Workflow ะทะฐะฟะธัะธ

1. **ะกะพะทะดะฐะฝะธะต ะทะฐะฟะธัะธ** - ะะพะปัะทะพะฒะฐัะตะปั ัะพะทะดะฐะตั ะทะฐะฟะธัั ั ะดะตัะฐะปัะผะธ (ะฐะฒัะพ, ะบะปะธะตะฝั, ััะปัะณะฐ, ะฒัะตะผั)
2. **ะฃะฒะตะดะพะผะปะตะฝะธะต ะผะตัะฐะฝะธะบะพะฒ** - ะัะตะผ ะผะตัะฐะฝะธะบะฐะผ ะพัะฟัะฐะฒะปัะตััั ัะฒะตะดะพะผะปะตะฝะธะต
3. **ะะตะนััะฒะธั ะผะตัะฐะฝะธะบะฐ**:
   - **ะัะธะฝััั** โ ะะฐะฟะธัั ัะพััะฐะฝัะตััั, ะฒัะตะผ ะพัะฟัะฐะฒะปัะตััั ัะฒะตะดะพะผะปะตะฝะธะต
   - **ะัะบะปะพะฝะธัั** โ ะัะตะผ ะพัะฟัะฐะฒะปัะตััั ัะฒะตะดะพะผะปะตะฝะธะต ะพะฑ ะพัะบะปะพะฝะตะฝะธะธ
   - **ะะทะผะตะฝะธัั ะฒัะตะผั** โ ะะตัะฐะฝะธะบ ะฟัะตะดะปะฐะณะฐะตั ะฝะพะฒะพะต ะฒัะตะผั
4. **ะกะพะณะปะฐัะพะฒะฐะฝะธะต ะฒัะตะผะตะฝะธ** - ะะพะปัะทะพะฒะฐัะตะปั ะธ ะผะตัะฐะฝะธะบ ัะพะณะปะฐัะพะฒัะฒะฐัั ะฒัะตะผั
5. **ะกะพััะฐะฝะตะฝะธะต** - ะะพัะปะต ัะพะณะปะฐัะพะฒะฐะฝะธั ะทะฐะฟะธัั ัะพััะฐะฝัะตััั ะฒ ะะ

## ะะฝะพะณะพัะทััะฝะพััั

ะัะต ัะตะบััั ััะฐะฝัััั ะฒ JSON ัะฐะนะปะฐั:
- `app/core/i18n/locales/pl.json` - ะะพะปััะบะธะน
- `app/core/i18n/locales/ru.json` - ะัััะบะธะน

ะะปั ะดะพะฑะฐะฒะปะตะฝะธั ะฝะพะฒะพะณะพ ัะทัะบะฐ:
1. ะกะพะทะดะฐะนัะต ัะฐะนะป `app/core/i18n/locales/{ะบะพะด_ัะทัะบะฐ}.json`
2. ะกะบะพะฟะธััะนัะต ััััะบัััั ะธะท ัััะตััะฒัััะตะณะพ ัะฐะนะปะฐ
3. ะะตัะตะฒะตะดะธัะต ะฒัะต ะบะปััะธ

## ๐๏ธ ะะพะฝัะธะณััะฐัะธั ะฑะฐะทั ะดะฐะฝะฝัั

ะัะพะตะบั ะฟะพะดะดะตัะถะธะฒะฐะตั ะดะฒะฐ ะฒะฐัะธะฐะฝัะฐ ะฑะฐะทั ะดะฐะฝะฝัั:

### SQLite (ะฟะพ ัะผะพะปัะฐะฝะธั, ะดะปั ัะตััะพะฒ/ัะฐะทัะฐะฑะพัะบะธ)

SQLite ะธัะฟะพะปัะทัะตััั ะฟะพ ัะผะพะปัะฐะฝะธั, ะตัะปะธ ะฝะต ัะบะฐะทะฐะฝั ะฟะฐัะฐะผะตััั PostgreSQL. ะะดะตะฐะปัะฝะพ ะฟะพะดัะพะดะธั ะดะปั:
- ะะพะบะฐะปัะฝะพะน ัะฐะทัะฐะฑะพัะบะธ
- ะขะตััะธัะพะฒะฐะฝะธั
- ะะตะฑะพะปััะธั ะฟัะพะตะบัะพะฒ

```env
# ะ .env ัะฐะนะปะต (ะธะปะธ ะพััะฐะฒััะต ะฟััััะผ ะดะปั SQLite ะฟะพ ัะผะพะปัะฐะฝะธั)
DATABASE_URL=sqlite+aiosqlite:///bot.db
```

### PostgreSQL (ะดะปั ะฟัะพะดะฐะบัะตะฝะฐ)

ะะปั ะฟัะพะดะฐะบัะตะฝะฐ ัะตะบะพะผะตะฝะดัะตััั ะธัะฟะพะปัะทะพะฒะฐัั PostgreSQL. ะััั ะดะฒะฐ ัะฟะพัะพะฑะฐ ะฝะฐัััะพะนะบะธ:

#### ะะฐัะธะฐะฝั 1: ะะพะปะฝัะน URL ะฟะพะดะบะปััะตะฝะธั

```env
DATABASE_URL=postgresql+asyncpg://user:password@host:5432/dbname
```

#### ะะฐัะธะฐะฝั 2: ะัะดะตะปัะฝัะต ะฟะฐัะฐะผะตััั (ัะตะบะพะผะตะฝะดัะตััั ะดะปั ะฑะตะทะพะฟะฐัะฝะพััะธ)

```env
# ะัะปะธ DATABASE_URL ะฝะต ัะบะฐะทะฐะฝ, ะธัะฟะพะปัะทััััั ััะธ ะฟะฐัะฐะผะตััั:
DB_HOST=localhost
DB_PORT=5432
DB_USER=postgres
DB_PASSWORD=your_secure_password
DB_NAME=telegram_bot
```

**ะัะธะพัะธัะตั ะฝะฐัััะพะตะบ:**
1. ะัะปะธ ัะบะฐะทะฐะฝ `DATABASE_URL` - ะธัะฟะพะปัะทัะตััั ะพะฝ
2. ะัะปะธ `DATABASE_URL` ะฟััั, ะฝะพ ัะบะฐะทะฐะฝั `DB_HOST`, `DB_USER`, `DB_NAME` - ัััะพะธััั URL ะธะท ะฟะฐัะฐะผะตััะพะฒ
3. ะัะปะธ ะฝะธัะตะณะพ ะฝะต ัะบะฐะทะฐะฝะพ - ะธัะฟะพะปัะทัะตััั SQLite ะฟะพ ัะผะพะปัะฐะฝะธั

**ะัะธะผะตั ะฝะฐัััะพะนะบะธ PostgreSQL:**

```bash
# ะฃััะฐะฝะพะฒะบะฐ PostgreSQL
sudo apt update
sudo apt install postgresql postgresql-contrib

# ะกะพะทะดะฐะฝะธะต ะฟะพะปัะทะพะฒะฐัะตะปั ะธ ะฑะฐะทั ะดะฐะฝะฝัั
sudo -u postgres psql
CREATE USER telegram_bot_user WITH PASSWORD 'secure_password';
CREATE DATABASE telegram_bot OWNER telegram_bot_user;
GRANT ALL PRIVILEGES ON DATABASE telegram_bot TO telegram_bot_user;
\q

# ะ .env ัะฐะนะปะต ะฑะพัะฐ:
DB_HOST=localhost
DB_PORT=5432
DB_USER=telegram_bot_user
DB_PASSWORD=secure_password
DB_NAME=telegram_bot
```

## ะะฐะทัะฐะฑะพัะบะฐ

### ะกะพะทะดะฐะฝะธะต ะฝะพะฒะพะน ะผะธะณัะฐัะธะธ

```bash
alembic revision --autogenerate -m "description"
alembic upgrade head
```

### ะขะตััะธัะพะฒะฐะฝะธะต

```bash
pytest
```

## ะะธัะตะฝะทะธั

MIT

